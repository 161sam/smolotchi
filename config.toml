[core]
tick_interval = 1.0
default_state = "WIFI_OBSERVE"

[policy]
allowed_tags = ["lab-approved"]
allowed_scopes = ["10.0.0.0/8", "192.168.0.0/16"]
allowed_tools = ["nmap", "ip", "arp", "ping"]
block_categories = ["system_attack", "file_steal"]
autonomous_categories = ["network_scan", "vuln_assess"]

[wifi]
enabled = true
safe_mode = true
iface = "wlan0"
scan_interval_sec = 30
allow_ssids = ["LAB-1", "LAB-2"]
auto_connect = true
preferred_ssid = "LAB-1"

[wifi.credentials]
"LAB-1" = "testtest12345"

[lan]
enabled = true
safe_mode = true
max_jobs_per_tick = 1
default_scope = "10.0.10.0/24"
noisy_scripts = ["http-enum", "http-title"]
allowlist_scripts = []

[ai]
max_hosts_per_plan = 16
max_steps = 80
autonomous_include_vuln_assess = true

[ai.exec]
concurrency = 1
batch_strategy = "per_host"
cooldown_between_actions_ms = 250
cooldown_between_hosts_ms = 800
max_retries = 1
retry_backoff_ms = 800

[ai.cache]
discovery_ttl_seconds = 600
use_cached_discovery = true
use_cached_portscan = true
portscan_ttl_seconds = 900
use_cached_vuln = true
vuln_ttl_seconds = 1800
vuln_ttl_http_seconds = 600
vuln_ttl_ssh_seconds = 3600
vuln_ttl_smb_seconds = 1800

[ai.throttle]
enabled = true
loadavg_soft = 0.90
loadavg_hard = 1.50
cooldown_multiplier_soft = 1.5
cooldown_multiplier_hard = 3.0
min_cooldown_ms = 150
max_cooldown_ms = 5000
use_cpu_temp = true
temp_soft_c = 70
temp_hard_c = 80
temp_multiplier_soft = 1.5
temp_multiplier_hard = 3.0

[ui]
host = "0.0.0.0"
port = 8080

[theme]
# optional: wenn gesetzt, l√§dt UI/Display tokens aus JSON
json_path = "theme.json"

[retention]
events_keep_last = 5000
events_older_than_days = 30

jobs_done_failed_older_than_days = 14
jobs_keep_last = 1000

artifacts_older_than_days = 30
artifacts_keep_last = 500
artifact_kinds_keep_last = ["lan_result"]

vacuum_after_prune = false

[watchdog]
enabled = true
interval_sec = 30
stuck_after_sec = 300
min_runtime_sec = 60
action = "reset"
max_resets = 2

[reports]
enabled = true
templates_dir = "smolotchi/api/templates/reports"

[report.findings]
enabled = true
allowlist = []
denylist = ["http-methods", "http-headers", "ssl-cert"]
deny_contains = []
max_findings_per_host = 12
max_output_chars = 600
max_output_lines = 6

[report.normalize]
enabled = true
force_severity = { "http-security-headers" = "info", "http-headers" = "info", "http-methods" = "info", "ssl-cert" = "info" }
force_tag = { "vulners" = "info" }

[report.diff]
enabled = true
compare_window_seconds = 86400
max_hosts = 50
baseline_host_summary_id = ""

[invalidation]
enabled = true
invalidate_on_port_change = true

[baseline]
enabled = false

[baseline.scopes]
"10.0.10.0/24" = []
