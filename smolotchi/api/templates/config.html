{% extends "layout.html" %}
{% block page_title %}Config{% endblock %}
{% block page_sub %}{{ config_path }} • edit + reload{% endblock %}

{% block content %}
<section class="card">
  <div class="row between">
    <div>
      <div class="muted">config.toml bearbeiten (Save schreibt Datei). Danach optional “Reload config”.</div>
    </div>

    <div class="btn-row">
      <button type="submit" form="config-form" class="btn">Save</button>
      <button type="submit" form="config-form" formaction="{{ url_for('config_save_reload') }}" class="btn">Save + Reload</button>
      <button type="submit" form="config-form" formaction="{{ url_for('config_reload') }}" class="btn secondary">Reload config</button>
    </div>
  </div>

  {% if msg %}
    <div class="events mt-lg">
      <div class="evt">
        <div class="evt-top">{{ msg.title }}</div>
        <pre>{{ msg.text }}</pre>
      </div>
    </div>
  {% endif %}
</section>

<section class="card">
  <h3 class="h3-tight">config.toml (editable)</h3>
  <form id="config-form" method="post" action="{{ url_for('config_save') }}">
    <textarea name="content" spellcheck="false" class="code-area font-mono w-100 min-h-52">{{ content }}</textarea>
  </form>
</section>

<section class="card">
  <h3 class="h3-tight">Aktive Konfiguration (parsed)</h3>

  <h3 class="h3-section">core</h3>
  <div class="events"><div class="evt"><pre>{{ cfg.core.__dict__ }}</pre></div></div>

  <h3 class="h3-section">policy</h3>
  <div class="events"><div class="evt"><pre>{{ cfg.policy.__dict__ }}</pre></div></div>

  <h3 class="h3-section">wifi</h3>
  <div class="events"><div class="evt"><pre>{{ cfg.wifi.__dict__ }}</pre></div></div>

  <h3 class="h3-section">lan</h3>
  <div class="events"><div class="evt"><pre>{{ cfg.lan.__dict__ }}</pre></div></div>

  <h3 class="h3-section">ui</h3>
  <div class="events"><div class="evt"><pre>{{ cfg.ui.__dict__ }}</pre></div></div>

  <h3 class="h3-section">theme</h3>
  <div class="events"><div class="evt"><pre>{{ cfg.theme.__dict__ }}</pre></div></div>
</section>
{% endblock %}
